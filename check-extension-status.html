<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ“´å±•ç‹€æ…‹æª¢æŸ¥</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>CDN Detector æ“´å±•ç‹€æ…‹æª¢æŸ¥</h1>
    
    <div class="section">
        <h2>ğŸ“‹ è«‹æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿæ“ä½œï¼š</h2>
        <ol>
            <li>
                <strong>é–‹å•Ÿæ“´å±•ç®¡ç†é é¢</strong>
                <br>åœ¨æ–°æ¨™ç±¤é ä¸­è¼¸å…¥ï¼š<code>chrome://extensions/</code>
            </li>
            <li>
                <strong>é–‹å•Ÿé–‹ç™¼è€…æ¨¡å¼</strong>
                <br>é»æ“Šå³ä¸Šè§’çš„ã€Œé–‹ç™¼è€…æ¨¡å¼ã€é–‹é—œ
            </li>
            <li>
                <strong>æ‰¾åˆ° CDN Detector æ“´å±•</strong>
                <br>æŸ¥çœ‹ä»¥ä¸‹è³‡è¨Šï¼š
                <ul>
                    <li>æ˜¯å¦é¡¯ç¤ºã€ŒéŒ¯èª¤ã€æŒ‰éˆ•ï¼Ÿå¦‚æœæœ‰ï¼Œé»æ“ŠæŸ¥çœ‹éŒ¯èª¤è©³æƒ…</li>
                    <li>é»æ“Šã€Œæª¢è¦–æª¢æŸ¥çš„èƒŒæ™¯é é¢ã€æˆ–ã€ŒService Workerã€é€£çµ</li>
                    <li>åœ¨é–‹ç™¼è€…å·¥å…·çš„ Console ä¸­æŸ¥çœ‹æ˜¯å¦æœ‰éŒ¯èª¤</li>
                </ul>
            </li>
            <li>
                <strong>é‡æ–°è¼‰å…¥æ“´å±•</strong>
                <br>é»æ“Šæ“´å±•å¡ç‰‡ä¸Šçš„é‡æ–°è¼‰å…¥æŒ‰éˆ•ï¼ˆå¾ªç’°ç®­é ­åœ–æ¨™ï¼‰
            </li>
        </ol>
    </div>

    <div class="section">
        <h2>ğŸ”§ æ‰‹å‹•æ¸¬è©¦æ–¹æ³•</h2>
        <p>å¦‚æœä¸Šè¿°æ–¹æ³•éƒ½å¤±æ•—ï¼Œè«‹å˜—è©¦ä»¥ä¸‹æ›¿ä»£æ–¹æ¡ˆï¼š</p>
        
        <h3>æ–¹æ³• 1ï¼šç›´æ¥åœ¨æ“´å±•çš„ Service Worker ä¸­æ¸¬è©¦</h3>
        <ol>
            <li>åœ¨æ“´å±•ç®¡ç†é é¢ï¼Œé»æ“Š CDN Detector çš„ã€ŒService Workerã€é€£çµ</li>
            <li>åœ¨æ‰“é–‹çš„é–‹ç™¼è€…å·¥å…· Console ä¸­ï¼Œè¼¸å…¥ä»¥ä¸‹å‘½ä»¤æ¸¬è©¦ message listenerï¼š
                <pre>chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
    console.log('Test message received:', message);
    if (message.type === 'TEST') {
        sendResponse({success: true, message: 'Test successful!'});
    }
});</pre>
            </li>
            <li>ç„¶å¾Œåœ¨å¦ä¸€å€‹æ¨™ç±¤é çš„ Console ä¸­æ¸¬è©¦ç™¼é€è¨Šæ¯ï¼š
                <pre>chrome.runtime.sendMessage('nonjdhdineehckicdnmnpmdapfdnlhbc', {type: 'TEST'}, response => {
    console.log('Response:', response);
});</pre>
            </li>
        </ol>

        <h3>æ–¹æ³• 2ï¼šä½¿ç”¨æ“´å±•çš„å…§éƒ¨é é¢</h3>
        <p>å‰µå»ºä¸€å€‹æ“´å±•å…§éƒ¨çš„æ¸¬è©¦é é¢å¯èƒ½æœƒæ›´å®¹æ˜“é€£æ¥ã€‚</p>
    </div>

    <div class="section">
        <h2>ğŸ› å¸¸è¦‹å•é¡Œè§£æ±º</h2>
        <h3>1. Service Worker æœªå•Ÿå‹•</h3>
        <p>å¦‚æœ Service Worker é¡¯ç¤ºã€Œéä½œç”¨ä¸­ã€ï¼Œå¯èƒ½éœ€è¦ï¼š</p>
        <ul>
            <li>é»æ“Šæ“´å±•åœ–æ¨™ä¾†å•Ÿå‹•å®ƒ</li>
            <li>å®Œå…¨é—œé–‰ä¸¦é‡æ–°é–‹å•Ÿ Chrome</li>
            <li>ç§»é™¤ä¸¦é‡æ–°å®‰è£æ“´å±•</li>
        </ul>

        <h3>2. æ¬Šé™å•é¡Œ</h3>
        <p>ç¢ºä¿æ¸¬è©¦é é¢çš„ URL åœ¨ manifest.json çš„ externally_connectable ä¸­ï¼š</p>
        <pre>{
  "externally_connectable": {
    "matches": [
      "file://*/*",
      "http://localhost/*",
      "https://localhost/*",
      "*://localhost:*/*",
      "*://127.0.0.1:*/*"
    ]
  }
}</pre>

        <h3>3. èªæ³•éŒ¯èª¤</h3>
        <p>æª¢æŸ¥ background.js æ˜¯å¦æœ‰èªæ³•éŒ¯èª¤ï¼Œç‰¹åˆ¥æ˜¯æœ€è¿‘ä¿®æ”¹çš„éƒ¨åˆ†ã€‚</p>
    </div>

    <div class="section">
        <h2>ğŸ’¡ æ›¿ä»£æ¸¬è©¦æ–¹æ¡ˆ</h2>
        <button onclick="testDirectAPI()">æ¸¬è©¦ Chrome API</button>
        <button onclick="checkExtensions()">åˆ—å‡ºæ‰€æœ‰æ“´å±•</button>
        <div id="testResult"></div>
    </div>

    <script>
        function testDirectAPI() {
            const resultDiv = document.getElementById('testResult');
            try {
                if (typeof chrome !== 'undefined' && chrome.runtime) {
                    resultDiv.innerHTML = '<p class="success">âœ… Chrome API å¯ç”¨</p>';
                    
                    // å˜—è©¦ç²å–æ“´å±•è³‡è¨Š
                    if (chrome.runtime.getManifest) {
                        try {
                            const manifest = chrome.runtime.getManifest();
                            resultDiv.innerHTML += '<p class="info">ç•¶å‰é é¢åœ¨æ“´å±•å…§éƒ¨ç’°å¢ƒä¸­</p>';
                            resultDiv.innerHTML += '<pre>' + JSON.stringify(manifest, null, 2) + '</pre>';
                        } catch (e) {
                            resultDiv.innerHTML += '<p class="info">ç•¶å‰é é¢ä¸åœ¨æ“´å±•å…§éƒ¨ç’°å¢ƒä¸­</p>';
                        }
                    }
                } else {
                    resultDiv.innerHTML = '<p class="error">âŒ Chrome API ä¸å¯ç”¨</p>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<p class="error">âŒ éŒ¯èª¤: ' + error.message + '</p>';
            }
        }

        function checkExtensions() {
            const resultDiv = document.getElementById('testResult');
            resultDiv.innerHTML = '<p class="info">è«‹æ‰‹å‹•æª¢æŸ¥æ“´å±•åˆ—è¡¨...</p>';
            resultDiv.innerHTML += '<p>å‰å¾€ chrome://extensions/ æŸ¥çœ‹æ‰€æœ‰å·²å®‰è£çš„æ“´å±•</p>';
        }
    </script>
</body>
</html> 